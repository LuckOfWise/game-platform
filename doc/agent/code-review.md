# コードレビューガイドライン

## 概要

このドキュメントは、AIエージェントがRuby on Railsコードをレビュー・修正提案する際の包括的なガイドラインです。
単なる構文チェックに留まらず、コードの意図、品質、保守性、安全性、効率性といった多角的な観点から深い洞察を提供することを目的としています。

## 指摘・修正提案の例

- このメソッド名は抽象的なので、より具体的な命名に変更を提案します（例: `check_image` → `image_must_be_allowed_content_type`）
- N+1クエリを防ぐため、`preload`の利用を推奨します
- 複雑なロジックはメソッド分割し、単一責任を徹底してください
- ビューのロジックはヘルパーやデコレーターへ移動してください
- テストの`it`文は具体的な期待値を明記してください

## Railsガイドライン
Rails共通のコードレビューガイドラインについては、[@doc/agent/code-review-rails.md](code-review-rails.md)を参照してください。

## プロジェクト固有のガイドライン

### 認証・認可
- 認証が必要なコントローラーでは明示的に `before_action` を記述すること

### テンプレート
- ビューテンプレートは **ERB** を使用
- BEMに基づいた独自クラスを使用すること
- パーシャル内にmarginを記述せず、親要素で制御すること

### フロントエンド
- JavaScript は Stimulus コントローラーで実装
- esbuild でバンドル

### テスト戦略
- 画面のあるページのテストは**システムスペック**で実装すること
- 認証・認可のテストは**リクエストスペック**で実装すること
- モデルスペックとシステムスペックを中心にテストを記述すること
